name: API Unit Tests

on:
  push:
    paths:
      - '**/api/**'
      - '.github/workflows/api**'
  pull_request:
    paths:
      - '**/api/**'
      - '.github/workflows/api**'

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: Test Node.js API
      uses: actions/setup-node@v1
      with:
        node-version: 8
    - name: Install Dependencies
      working-directory: ./api
      run: npm ci
    - name: Run Tests
      env:
        accessKeyId: ${{ secrets.AWS_accessKeyId }}
        secretAccessKey: ${{ secrets.AWS_secretAccessKey }}
        region: ${{ secrets.AWS_region }}
      working-directory: ./api
      run: npm test
